<!DOCTYPE html>    
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Simple Scheduler</title>
    <script src="https://unpkg.com/react@15.3.2/dist/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/JSXTransformer.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://unpkg.com/react-dom@15.3.2/dist/react-dom.js"></script>

    <!--- Bootstrap --->
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
	<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</head>

<body>
<div class="panel panel-body">
<h1>Simple Scheduler</h1>
<p>This is a small app that assigns and schedules tasks. Click on the "Add Task" button below to add a task. Once a task is posted it can be deleted.</p>
	<!---<div id="button-main"></div>--->
	<div id="schedule-main"></div>

	<script type="text/jsx">



	//this is the main component container that populates the list of tasks
	var TaskBoard = React.createClass({
			getInitialState: function(){
				console.log("initializing array");
				return{
					//note: initally this is empty
					//we can populate the array by directly manipulating it
					//maybe in the future store array somewhere and unload it
					tasksArray: [] 
				}
			},

			//place new task
			submitTask: function(newText){
				console.log("passing into updateTask()" + newText + "and ");
				var arr = this.state.tasksArray;
				console.log("before: "+arr);
				if(newText===""){
					newText = "(Empty Task)";
				}
				arr.push(newText);
				//arr.splice(i,0,newText);	//adds to array with 0 deletes
				this.setState({tasksArray: arr});
				console.log("after: "+arr);
			},

			//removing a published task
			removeTask: function(i){
				var arr = this.state.tasksArray;
				console.log("before: "+arr);
				arr.splice(i,1);
				this.setState({tasksArray: arr});
				console.log("after: "+arr);
			},

			//call this function whenever any changes have been made to the
			//array to update the list view
			//edit modify task
			updateTask: function(newText, i){
				console.log("determining tasks");
				var arr = this.state.tasksArray;
				//arr.splice(i,0,newText);	//adds to array with 0 deletes
				arr[i] = newText;
				this.setState({tasksArray: arr});
			},


			//assign each task with identifier and text that makes values
			//and functions accessible outside the scope of this component
			eachTask: function(text,i){
				return	(
						<li className="list-group-item">
							<IndividualTask key={i} index={i} updateArray={this.updateTask}>
								{text} <a onClick={this.removeTask} href="#">x</a>
							</IndividualTask>
						</li>
						)
			},

			render: function(){
				return	(

							<div className="TaskBoard">
								<notifications> </notifications>
								
								<div className="panel panel-default">
								  <div className="panel-heading"><b>Pending Tasks</b></div>
								  <AddingTask submitTaskText={this.submitTask}></AddingTask>
								  <ul className="list-group">
								  	{
								    this.state.tasksArray.map(this.eachTask)
								  	}
								  </ul>
								</div>

								{

									
								}
							</div>

				);
			}
	});

	//this main task button is used to display the new tas form 
	var AddingTask = React.createClass({
		getInitialState: function(){
			return{addingTask: false}
		},

		//used to change the state to adding a task
		addTaskBtn: function(){
			console.log("adding a task now");
			this.setState({addingTask: true});
		},

		submitBtn: function(){
			console.log("Submitting task");
			this.props.submitTaskText(this.refs.taskid.value);

			this.setState({addingTask: false});
		},

		cancelBtn: function(){
			this.setState({addingTask: false});
		},

		showFormRender: function(){
			return(
					<div>

						<input type="text" className="form-control" placeholder="Schedule a Task" ref="taskid" defaultValue=""></input>
						<button onClick={this.submitBtn} type="button" className="btn btn-default pull-right">Submit</button>
						<button onClick={this.cancelBtn} type="button" className="btn btn-danger pull-right">Cancel</button>
						<br/>
						<br/>
					</div>
					
			);
			
		},

		hideFormRender: function(){
			return	(
				<div>
					<button onClick={this.addTaskBtn} type="button" className="btn btn-default">Add Task</button>
				</div>
			);

		},

		render: function(){
			console.log(this.state.addingTask);
			if(this.state.addingTask){
				return this.showFormRender();
			}else{
				return this.hideFormRender();
			}
		}

	});

	var IndividualTask = React.createClass({
		getInitialState: function(){
			return{editTask: false}
		},

		editBtn: function(){
			console.log("edit mode");
		},

		deleteBtn: function(){
			console.log("deleting task");
			this.props.deleteTask(this.refs.taskid.value);
		},

		saveBtn: function (){
			console.log("saving task");
		},

		renderDefault: function(){
			return	(
					<div>
						{this.props.children} 
					</div>
			);
		},

		renderModify: function(){

		},

		render: function(){
			//display each individual form
			return this.renderDefault();
		}
	});


	ReactDOM.render(<TaskBoard/>, document.getElementById('schedule-main'));
	//ReactDOM.render(<AddingTask/>, document.getElementById('button-main'));

	</script>
</div>
	
</body>
</html>